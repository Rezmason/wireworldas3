/*** Wireworld Player by Jeremy Sachs. June 8, 2010** Feel free to distribute the source, just try not to hand it off to some douchebag.* Keep this header here.** Please contact jeremysachs@rezmason.net prior to distributing modified versions of this class.*/package net.rezmason.wireworld {	//---------------------------------------	// IMPORT STATEMENTS	//---------------------------------------	import com.adobe.images.PNGEncoder;		import flash.display.BitmapData;	import flash.events.Event;	import flash.net.FileReference;	import flash.utils.ByteArray;		// A little utility for saving files, with sequential names	// and other clever bits.		internal final class ImageSaver {				//---------------------------------------		// PRIVATE VARIABLES		//---------------------------------------		private var fileReference:FileReference = new FileReference();				private var snapNumber:int = 1;		private var __fileName:String, _fileName:String;				//---------------------------------------		// CONSTRUCTOR		//---------------------------------------		public function ImageSaver():void {			fileReference.addEventListener(Event.COMPLETE, followthrough);		}				//---------------------------------------		// INTERNAL METHODS		//---------------------------------------				internal function get fileName():String {			return _fileName;		}				internal function set fileName(value:String):void {			_fileName = value;			__fileName = _fileName.substring(0, _fileName.indexOf(".")) + "_snapshot_";		}				internal function resetCount():void {			snapNumber = 1;		}				internal function save(image:BitmapData):void {			var _png:ByteArray = PNGEncoder.encode(image);			fileReference.save(_png, unescape(__fileName) + snapNumber + ".png");		}				//---------------------------------------		// PRIVATE METHODS		//---------------------------------------				// Comes up with a suggestion for a new name for the next saved file.		private function followthrough(event:Event):void {						var _name:String = fileReference.name;						_name = _name.substring(0, fileReference.name.indexOf("."));			_name = _name.substring(0, fileReference.name.lastIndexOf("_")) || _name;						_name = _name + "_";						if (__fileName != _name) {				__fileName = _name;				snapNumber = 1;			}						snapNumber++;		}	}}